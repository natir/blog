<!DOCTYPE html>
<html lang="en">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta http-equiv="content-type" content="text/html; charset=utf-8">

    <!-- Enable responsiveness on mobile devices-->
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

    <title>Yet Another Bioinformatic blog</title>

    <!-- css -->
    <link rel="stylesheet" href="/cayman.css">
    <link rel="stylesheet" href="/add.css">

    <!-- font -->
    <link rel="stylesheet" href="/fonts/fork_awesome/css/fork-awesome.min.css">
    <link rel="stylesheet" href="/fonts/academicons/css/academicons.min.css">
    
    <!-- js -->

    

    
<script>
  MathJax = {
      tex: {
	  inlineMath: [['$', '$'], ['\\(', '\\)']]
      },
      svg: {
	  fontCache: 'global'
      }
  };
</script>

<script type="text/javascript" id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js"> </script>



    <!-- Fathom - simple website analytics - https://github.com/usefathom/fathom -->
<script>
(function(f, a, t, h, o, m){
	a[h]=a[h]||function(){
		(a[h].q=a[h].q||[]).push(arguments)
	};
	o=f.createElement('script'),
	m=f.getElementsByTagName('script')[0];
	o.async=1; o.src=t; o.id='fathom-script';
	m.parentNode.insertBefore(o,m)
})(document, window, '//stats.pierre.marijon.fr/tracker.js', 'fathom');
fathom('set', 'siteId', 'NYKUR');
fathom('trackPageview');
</script>
<!-- / Fathom -->



    
 <script data-isso="//isso.pierre.marijon.fr/" data-isso-reply-to-self="true" data-isso-require-author="true" data-isso-reveal-on-click="inf" src="https://isso.pierre.marijon.fr/js/embed.min.js"></script>

  </head>

  <body>

    <a href="https://github.com/natir/blog" class="github-corner" aria-label="View source on GitHub"><svg width="80" height="80" viewBox="0 0 250 250" style="fill:#485F41; color:#B6C8B1; position: absolute; top: 0; border: 0; right: 0;" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a><style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style>

    
    <section class="page-header">
      <h1 class="project-name">Yet Another Bioinformatic blog</h1>
      <a class="btn" href="/">Home</a>
      <a class="btn" href="//pierre.marijon.fr">About</a>
      <a class="btn" href="/rss.xml">RSS feed</a>
    </section>


    <section class="main-content">
      
  <section class="post">
    <div class="title-and-info">
      <h1>State-of-the-art long reads overlapper-compare</h1>
      <div class="info">
    	<span>7 minute read</span>
    	
    	<span class='divider'/>
    	<span>13 April 2018</span>
    	
    	
    	
      </div>
    </div>
    <article>
      <h2 id="introduction">Introduction</h2>
<p>In 2017, Chu <em>et la.</em> wrote a review <sup class="footnote-reference"><a href="#fn1">1</a></sup> to present and compare 5 long-read overlapping tools, on 4 datasets (including 2 synthetic ones).
This paper is very cool and clear. The authors compare overlappers with respect to peak memory, wall clock time, sensitivity and precision. Table 2 from this paper presents sensitivity and precision:</p>
<p><img src="https://blog.pierre.marijon.fr/long-reads-overlapper-compare/table_res_review.png" alt="table 2 of review" /></p>
<p>Overlappers show better results on synthetic datasets than on real data. We can observe an important loss of sensitivity: 59.6-83.8% on the Pacbio real dataset, compared to 88.9-92.4% on the simulated data.</p>
<p>So, ok, overlappers dont't achieve perfect sensibility, but <strong>do they miss the same overlaps</strong>?</p>
<h2 id="materials-methods">Materials &amp; Methods</h2>
<h3 id="datasets">Datasets</h3>
<p>I selected the two real sequencing datasets in Chu <em>et al.</em><sup class="footnote-reference"><a href="#fn1">1</a></sup>, because they had the highest variance in sensitivity, so we can see the most extreme effects in how long-read overlappers possibly find different overlaps.</p>
<h3 id="what-is-an-overlap">What is an overlap</h3>
<p>I will not bore you with formal definitions :)</p>
<p>We will consider 3 type of overlaps, according to Algorithm 5 presented in the minimap publication <sup class="footnote-reference"><a href="#fn2">2</a></sup></p>
<p><img src="https://blog.pierre.marijon.fr/long-reads-overlapper-compare/minimap_ovl_filter.png" alt="algorithm 5 in minimap and miniasm article by Heng Li" /></p>
<p>Internal match:
: Just a short similarity localized in the middle section of both reads, which is probably due to a repetitive region and not a true overlap</p>
<p>Containment:
: One read is completely contained in another</p>
<p>Classic overlap:
: Deemed a regular suffix-prefix overlap</p>
<p>We will check the results of overlappers, and for each entry that isn't an internal match nor an containment overlap, we store the pair of reads as elements of the set of all overlaps found by the overlapper.</p>
<h3 id="overlappers">Overlappers</h3>
<p>We used:</p>
<ul>
<li>graphmap v0.5.2 <sup class="footnote-reference"><a href="#fn3">3</a></sup></li>
<li>hisea 39e01e98ca <sup class="footnote-reference"><a href="#fn4">4</a></sup></li>
<li>mhap 1.6 and 2.1 <sup class="footnote-reference"><a href="#fn5">5</a></sup></li>
<li>minimap 0.2-r124 <sup class="footnote-reference"><a href="#fn2">2</a></sup></li>
<li>minimap2 2.10 <sup class="footnote-reference"><a href="#fn6">6</a></sup></li>
</ul>
<p>We used parameters recommended by Chu <em>et al.</em><sup class="footnote-reference"><a href="#fn1">1</a></sup> and default parameters for HISEA.</p>
<h3 id="venn-diagram-generation">Venn diagram generation</h3>
<p>We used a Python script to parse the output file of each overlapper, filter overlaps, generate a Venn diagram, and compute the Jaccard index.
All scripts and steps to reproduce this analysis are available in this <a href="https://github.com/natir/SOTA-long-read-overlapping-tools-comparative-analysis-data">repository</a>.</p>
<h2 id="results">Results</h2>
<h3 id="nanopore-real-data">Nanopore real data</h3>
<p><img src="https://blog.pierre.marijon.fr/long-reads-overlapper-compare/nanopore_venn.png" alt="venn diagram for nanopore real dataset" /></p>
<p>In the center of the above diagram we have the number of overlaps found by all overlappers. We call this set the <em>core overlaps</em>. Here for this dataset, core overlaps contain 8,980,212 overlaps.
Around this center, we highlight some of the largest disparities between overlappers:</p>
<table><thead><tr><th align="left">dataset composition</th><th align="right">number of overlaps</th><th align="right">% of core overlaps</th></tr></thead><tbody>
<tr><td align="left">core overlaps - hisea overlaps</td><td align="right">898,995</td><td align="right">10.01 %</td></tr>
<tr><td align="left">hisea overlaps $\cap$ mhap overlaps</td><td align="right">464,546</td><td align="right">5.17 %</td></tr>
<tr><td align="left">core overlaps - mhap overlaps</td><td align="right">198,989</td><td align="right">2.21 %</td></tr>
<tr><td align="left">core overlaps - graphmap overlaps</td><td align="right">198,014</td><td align="right">2.21 %</td></tr>
</tbody></table>
<p>In addition, out of the 11,352,915 overlaps found by mhap, 4.96 % of these are found only by this overlapper. For hisea, the corresponding value is 1.55 % (out of 10,114,576 overlaps).</p>
<table><thead><tr><th align="right"></th><th align="right">mhap</th><th align="right">minimap2</th><th align="right">graphmap</th><th align="right">hisea</th></tr></thead><tbody>
<tr><td align="right">mhap</td><td align="right"></td><td align="right">0.88</td><td align="right">0.85</td><td align="right">0.82</td></tr>
<tr><td align="right">minimap2</td><td align="right">0.88</td><td align="right"></td><td align="right">0.94</td><td align="right">0.84</td></tr>
<tr><td align="right">graphmap</td><td align="right">0.85</td><td align="right">0.94</td><td align="right"></td><td align="right">0.83</td></tr>
<tr><td align="right">hisea</td><td align="right">0.82</td><td align="right">0.84</td><td align="right">0.83</td><td align="right"></td></tr>
</tbody></table>
<p>The above matrix shows the Jaccard similarity coefficient (cardinality of intersection divided by cardinality of union) between pairs of overlappers. </p>
<h3 id="pacbio-real-data">Pacbio real data</h3>
<p><img src="https://blog.pierre.marijon.fr/long-reads-overlapper-compare/pacbio_venn.png" alt="venn diagram for pacbio real dataset" /></p>
<p>For the Pacbio dataset, core overlaps contain 3,407,577 overlaps. 
Other large disparities between overlappers are:</p>
<table><thead><tr><th align="left">dataset composition</th><th align="right">number of overlaps</th><th align="right">% of core overlaps</th></tr></thead><tbody>
<tr><td align="left">core overlaps - graphmap overlaps</td><td align="right">713,161</td><td align="right">20.93 %</td></tr>
<tr><td align="left">minimap2-only overlaps</td><td align="right">538,118</td><td align="right">15.79 %</td></tr>
<tr><td align="left">mhap overlaps $\cap$ minimap2 overlaps</td><td align="right">503,431</td><td align="right">14.77 %</td></tr>
<tr><td align="left">core overlaps - hisea overlaps</td><td align="right">352,376</td><td align="right">10.44 %</td></tr>
<tr><td align="left">mhap-only overlaps</td><td align="right">319,744</td><td align="right">9.38 %</td></tr>
</tbody></table>
<p>Out of all overlaps found by minimap2 (5,640,643), 9.54% of these overlaps are found only by this overlapper, for mhap the corresponding value is 5.98% (out of 5,336,610 overlaps).</p>
<table><thead><tr><th align="right"></th><th align="right">mhap</th><th align="right">minimap2</th><th align="right">graphmap</th><th align="right">hisea</th></tr></thead><tbody>
<tr><td align="right">mhap</td><td align="right"></td><td align="right">0.83</td><td align="right">0.70</td><td align="right">0.76</td></tr>
<tr><td align="right">minimap2</td><td align="right">0.83</td><td align="right"></td><td align="right">0.67</td><td align="right">0.74</td></tr>
<tr><td align="right">graphmap</td><td align="right">0.70</td><td align="right">0.67</td><td align="right"></td><td align="right">0.74</td></tr>
<tr><td align="right">hisea</td><td align="right">0.76</td><td align="right">0.74</td><td align="right">0.74</td><td align="right"></td></tr>
</tbody></table>
<p>Again the above matrix shows Jaccard similarity coefficient.</p>
<h3 id="comparison-across-versions">Comparison across versions</h3>
<p>At first we used mhap 2.1, using the same parameters as in Chu <em>et al.</em><sup class="footnote-reference"><a href="#fn1">1</a></sup>. But actually, Chu. <em>et al</em> used mhap 1.6. This version change yielded surprising results: many more overlaps were found only by mhap 2.1.
Here is a comparison between the two executions of mhap 1.6 and 2.1 using the same command-line parameters, in terms of shared and exclusive overlaps.</p>
<p><img src="https://blog.pierre.marijon.fr/long-reads-overlapper-compare/mhap_venn_same.png" alt="venn diagram for mhap compare same parameter" /></p>
<p>Jaccard similarity 0.72, 0.26</p>
<p>mhap 2.1 found many more overlaps than mhap 1.6. But it turns out that this is because mhap 1.6 calculates a similarity score between reads and mhap 2.1 calculates a distance between reads, the meaning of the --threshold option is different between the two versions, so we should have not used the same parameter value for both versions (thanks to Sergey Koren for pointing this out). This explains why a user may get significantly different results between the two versions, when running them carelessly with identical parameters. Below, we plot the Venn diagrams of overlaps found only by mhap 1.6 with --threshold 0.02 for pacbio and --threshold 0.04 (like Chu. <em>et al</em>) and only by mhap 2.1 with --threshold 0.75 for pacbio and --threshold 0.78 for nanopore.</p>
<p><img src="https://blog.pierre.marijon.fr/long-reads-overlapper-compare/mhap_venn.png" alt="venn diagram for mhap compare" /></p>
<p>Jaccard similarity 0.84, 0.96</p>
<p>Both software find roughly the same set of overlaps, with the trend that mhap1.6 tended to find a bit more (it would be interesting to evaluate whether those were correct or wrong overlaps).</p>
<p>And another comparison between minimap and minimap2:</p>
<p><img src="https://blog.pierre.marijon.fr/long-reads-overlapper-compare/minimap_venn.png" alt="venn diagram for mhap compare" /></p>
<p>Jaccard similarity 0.71, 0.98</p>
<p>For the pacbio dataset, minimap2 finds significantly (1.6M) more overlaps than minimap (which found 4M overlaps). But for the nanopore dataset, both software roughly agree.</p>
<h2 id="conclusion">Conclusion</h2>
<p>Overlapper tools behave quite similarly, but on real pacbio datasets<sup class="footnote-reference"><a href="#fn1">1</a></sup>, sensibility, precision, and the set of overlaps found across tools can be very different.
Such a difference can also exist between two versions of the same tool.</p>
<p>Comparison of overlappers based on a quantitative measurement (sensitivity, precision) is useful but isn't perfect: two tools with the same sensitivity for a given set could still detect a different set of overlaps, see e.g. mhap and minimap2 for the nanopore set.</p>
<p>Some publications use quality of error-correction, or results of genome assembly, as quality metrics to compare overlappers. It's a good idea but correction and assembly tools make additional choices in the overlaps they keep, and it's not easy to relate assembly or error-correction imperfections and wrong or missed overlaps.</p>
<p>From our tests, there is no clear best overlapper software so far.</p>
<p>It could by interesting to study whether certain tools have a bias when finding overlaps, linked to e.g length of reads, mapping length, error rate, %GC, specific kmer composition, etc …
A study like this could possibly reveal some intrinsic properties of the algorithms used in overlappers.</p>
<p>Is it a good idea to create a reconciliation tool for overlappers? We note that the correction and assembly tools seek to reduce the amount of overlaps they use, through e.g. graph transitivity reduction, Best Overlap Graph, the MARVEL approach<sup class="footnote-reference"><a href="#fn7">7</a></sup>.</p>
<h5 id="acknowledgment">Acknowledgment</h5>
<ul>
<li>Sergey Koren</li>
<li>Rayan Chikhi</li>
<li>Jean-Stéphane Varré</li>
</ul>
<h5 id="reference">Reference</h5>
<div class="footnote-definition" id="fn1"><sup class="footnote-definition-label">1</sup>
<p>Innovations and challenges in detecting long read overlaps: an evaluation of the state-of-the-art by Chu <em>et al.</em> doi:<a href="http://doi.org/10.1093/bioinformatics/btw811">10.1093/bioinformatics/btw811</a></p>
</div>
<div class="footnote-definition" id="fn2"><sup class="footnote-definition-label">2</sup>
<p>Minimap and miniasm: fast mapping and de novo assembly for noisy long sequences by Heng Li doi:<a href="https://doi.org/10.1093/bioinformatics/btw152">10.1093/bioinformatics/btw152</a></p>
</div>
<div class="footnote-definition" id="fn3"><sup class="footnote-definition-label">3</sup>
<p>Fast and sensitive mapping of nanopore sequencing reads with GraphMap by Sovic <em>et al.</em> doi:<a href="https://doi.org/10.1038/ncomms11307">10.1038/ncomms11307</a></p>
</div>
<div class="footnote-definition" id="fn4"><sup class="footnote-definition-label">4</sup>
<p>HISEA: HIerarchical SEed Aligner for PacBio data by Khiste and Ilie doi:<a href="https://doi.org/10.1186/s12859-017-1953-9">10.1186/s12859-017-1953-9</a></p>
</div>
<div class="footnote-definition" id="fn5"><sup class="footnote-definition-label">5</sup>
<p>Assembling large genomes with single-molecule sequencing and locality-sensitive hashing Berlin <em>et al.</em> doi:<a href="https:doi.org/10.1038/nbt.3238">10.1038/nbt.3238</a></p>
</div>
<div class="footnote-definition" id="fn6"><sup class="footnote-definition-label">6</sup>
<p>Minimap2: pairwise alignment for nucleotide sequences by Li <em>et al.</em> <a href="https://arxiv.org/abs/1708.01492v5">arxiv</a></p>
</div>
<div class="footnote-definition" id="fn7"><sup class="footnote-definition-label">7</sup>
<p>Supplementary information of The axolotl genome and the evolution of key tissue formation regulators by Nowoshilow <em>et al.</em> doi:<a href="https://doi.org/10.1038/nature25458">10.1038/nature25458</a></p>
</div>

    </article>
  </section>

  <h2>Comments:</h2>
    <section id="isso-thread"></section>
    
      <footer class="site-footer">
	<span class="site-footer-credits">
	  <center>
	    <a rel="license" href="http://creativecommons.org/licenses/by/4.0/">
	      <img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by/4.0/88x31.png" />
	    </a>
	  </center>
	  <br />
	  <span xmlns:dct="http://purl.org/dc/terms/" property="dct:title">Yet Another Bioinformatic blog</span> by <span xmlns:cc="http://creativecommons.org/ns#" property="cc:attributionName">Pierre Marijon</span> is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International License</a>.<br />Based on a work at <a xmlns:dct="http://purl.org/dc/terms/" href=https:&#x2F;&#x2F;blog.pierre.marijon.fr&#x2F;long-reads-overlapper-compare&#x2F; rel="dct:source">blog.pierre.marijon.fr</a>.</span>
      </footer>
    </section>
    

    
<section class="share-page">
  Share this on &rarr; <br/>
  <a href="https://twitter.com/intent/tweet?text=State-of-the-art long reads overlapper-compare&url=https:&#x2F;&#x2F;blog.pierre.marijon.fr&#x2F;long-reads-overlapper-compare&#x2F;&via=pierre_marijon&related=pierre_marijon" rel="nofollow" target="_blank" title="Share on Twitter">
    <span class="fa fa-twitter fa-3x"></span>
  </a>
  <a href="http://www.linkedin.com/shareArticle?mini=true&url=https:&#x2F;&#x2F;blog.pierre.marijon.fr&#x2F;long-reads-overlapper-compare&#x2F; &title=State-of-the-art long reads overlapper-compare&source=https:&#x2F;&#x2F;blog.pierre.marijon.fr">
    <span class="fa fa-linkedin fa-3x"></span>
  </a>
</section> 


  </body>
</html>
